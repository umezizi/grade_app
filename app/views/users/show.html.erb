<% provide(:title, @user.name) %>
<div class="container bg-light">
  <div class="row">
    <aside class="col-md-4">
      <section class="user_info">
        <p>
          <% if @user.image.attached? %>
            <%= image_tag @user.user_image_resize("250x250") %>
          <% else %>
            <%= image_tag("avatar_image.png", :size => "250x250") %>
          <% end %>
        </p>
        <p><strong><%= @user.name %><strong></p>
      </section>
      <section class="stats">
        <p><%= @user.profile %></p>
        <p>ホームジム</p>
        <% if @gyms.any? %>
          <div class="gym_avatars">
            <% @gyms.each do |gym| %>
              <% if gym.gym_image.attached? %>
                <%= link_to image_tag(gym.gym_image_resize("60x60")), gym %>
              <% else %>
                <%= link_to image_tag("gym_image.jpg", :size => "60x60"), gym %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </section>
    </aside>
    <div class="col-md-8">
      <%= render 'post_form' if user_signed_in? && @user == current_user %>
      <% if @user.posts.any? %>
        <h3>Microposts (<%= @user.microposts.count %>)</h3>
        <ol class="microposts">
          <%= render @microposts %>
        </ol>
        <%= paginate @posts %>
      <% end %>
    </div>
  </div>
</div>


<ul class="posts">
  <% @feed_items.each do |feed| %>
    <h4 class="list-group-item-heading">
      <%= link_to feed.user.name, feed.user %>
    </h4>
    <p class="list-group-item-text">
      <%= feed.comment %>
    </p>
    <p class="list-group-item-text">
      Posted <%= time_ago_in_words(feed.created_at) %> ago.
      <% if current_user == feed.user %>
        <%= link_to "delete", feed, method: :delete,
                                    data: { confirm: "コメントを削除しますか？" } %>
      <% end %>
    </p>
  <% end %>
  <%= paginate @feed_items %>
</ul>

<ul class="reviews">
  <% @reviews.each do |review| %>
    <h4 class="list-group-item-heading">
      <%= review.title %>
    </h4>
    <p class="list-group-item-text">
      <%= review.content %>
    </p>
  <% end %>
  <%= paginate @reviews %>
</ul>


<ul class="posts">
  <% @posts.each do |post| %>
    <h4 class="list-group-item-heading">
      <%= link_to post.user.name, post.user %>
    </h4>
    <p class="list-group-item-text">
      <%= post.comment %>
    </p>
    <p class="list-group-item-text">
      Posted <%= time_ago_in_words(post.created_at) %> ago.
      <% if current_user == post.user %>
        <%= link_to "delete", post, method: :delete,
                                    data: { confirm: "コメントを削除しますか？" } %>
      <% end %>
    </p>
  <% end %>
  <%= paginate @posts %>
</ul>

<ul class="gym">
  <% @gyms.each do |gym| %>
    <% if gym.gym_image.attached? %>
      <%= link_to image_tag(gym.gym_image_resize("60x60")), gym %>
    <% end %>
    <h4 class="list-group-item-heading">
      <%= link_to gym.gym_name, gym %>
    </h4>
    <p class="list-group-item-text">
      <%= gym.address %>
    </p>
    <p class="list-group-item-text">
      <% if current_user == @user %>
        <div id="like_form">
          <%= form_for(current_user.active_relationships.find_by(favorite_gym_id: gym.id),
                       html: { method: :delete }) do |f| %>
            <%= f.submit "ホームジム解除", class: "btn" %>
          <% end %>
        </div>
      <% end %>
    </p>
  <% end %>
  <%= paginate @posts %>
</ul>


